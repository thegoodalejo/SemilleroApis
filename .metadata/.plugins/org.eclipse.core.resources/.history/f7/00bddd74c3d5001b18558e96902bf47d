package com.sophossolutions.stepdefinitions;

import org.openqa.selenium.By;

import com.sophossolutions.pages.MercadoLibreCarrito;
import com.sophossolutions.pages.MercadoLibreCarritoHome;
import com.sophossolutions.pages.MercadoLibreHome;
import com.sophossolutions.pages.MercadoLibreResult;

import io.cucumber.java.en.Given;
import io.cucumber.java.en.Then;
import io.cucumber.java.en.When;


public class MercaLibreStepDefinitions {
	
	MercadoLibreHome McLbhome;
	MercadoLibreResult McLbresult;
	MercadoLibreCarrito MCCarrito;
	MercadoLibreCarritoHome MCLCHome;
	
	@Given("El usuario se encuentra en la paguina home")
	public void deseoIrALaPaginaDe() {
		McLbhome.open();
		try {
			Thread.sleep(60000);
		} catch (InterruptedException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}
	}

	@When("Agrega un producto (.+) al carrito $")
	public void ingresoElProductoNeverasParaAgregarloAlCarrito(String produc) {
		
		int np = (int)(Math.random()*6+1);
		System.out.println(np);
		System.out.println("........................");
		for(int i = 0; i < np; i++) {
			int na = (int)(Math.random()*40+1);
			
			System.out.println(na);
			
			String title = "(//section[@class='ui-search-results ui-search-results--without-disclaimer']//h2[@class='ui-search-item__title'])[%s]";
			By NombrePro = By.xpath(String.format(title, String.valueOf(na)));
			McLbhome.AgregarACarrito(produc);
			McLbresult.AgregarElProducto(NombrePro);
			if(!MCCarrito.SelecCarrito()) {
				i--;
			}
				
		}
		
		MCCarrito.cliccarrito();
	
	}

	@Then("El producto aparece en el carrito")
	public void validoQueElProductoEsteEnElCarrito() {
		MCLCHome.VerificarDatos();
		try {
			Thread.sleep(30000);
		} catch (InterruptedException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}
		System.out.println("Then");
		
		
	}

	

}
